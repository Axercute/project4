import"../chunks/Bzak7iHL.js";import{p as ne,f as w,i as C,d as p,t as q,b as h,c as oe,s as m,g as v,h as t,r as l,k as M,e as fe,a as ve,$ as _e,u as le,l as be,n as he}from"../chunks/DGYHhCVK.js";import{d as ie,s as E,e as xe}from"../chunks/Bdp7olBi.js";import{i as K}from"../chunks/D88P7bS6.js";import{e as X,i as Z}from"../chunks/D1Y47qj-.js";import{r as de}from"../chunks/BaNJaI3l.js";import{b as ce,a as ye}from"../chunks/jT66NYJA.js";import{g as we}from"../chunks/C5d16oRV.js";import{o as me}from"../chunks/p91XhKJe.js";import{s as ae}from"../chunks/Bjt-LPLC.js";import{b as ue}from"../chunks/BK7M320b.js";import{p as re}from"../chunks/C8lKBQ5F.js";import{D as H}from"../chunks/n6HvnmwO.js";const ke=async({fetch:_})=>{try{const i=await(await _("/api/service")).json(),d=i.filter(u=>u.category==="Consultation"),e=i.filter(u=>u.category==="Standard Treatment"),o=i.filter(u=>u.category==="TCM Wellness Program"),g=i.filter(u=>u.category==="Package Price");return{consultation:d,standardTreatment:e,wellnessProgramme:o,packagedTreatment:g}}catch(r){console.error("Error fetching appointments:",r)}},nt=Object.freeze(Object.defineProperty({__proto__:null,load:ke},Symbol.toStringTag,{value:"Module"}));var Te=(_,r)=>{v(r,!t(r))},Se=(_,r,i,d)=>{r(t(i)),v(d,!1)},Me=w('<div class="px-4 py-1 text-center hover:bg-amber-400 cursor-pointer"> </div>'),Ce=w('<div class="absolute w-full z-50 bg-white mt-1 shadow"></div>'),Pe=w('<div class="w-50 mx-auto relative"><div> </div> <div class="relative"><!></div></div>');function V(_,r){ne(r,!0);let i=re(r,"value",15),d=re(r,"selected",7),e=C(""),o=C("");me(()=>{const n=x=>{t(o)&&!t(o).contains(x.target)&&v(e,!1)};return document.addEventListener("click",n),()=>{document.removeEventListener("click",n)}});const g=n=>{typeof n=="string"?(d(n),i(n)):typeof n=="object"&&n!==null&&(d(n.english_name??n.name??JSON.stringify(n)),i(n)),v(e,!1)};var u=Pe(),b=p(u);b.__click=[Te,e];var F=p(b,!0);l(b),ue(b,n=>v(o,n),()=>t(o));var O=m(b,2),R=p(O);{var I=n=>{var x=Ce();X(x,21,()=>r.options,Z,(N,k)=>{var S=Me();S.__click=[Se,g,k,e];var c=p(S,!0);l(S),q(f=>E(c,f),[()=>typeof t(k)=="string"?t(k):t(k).english_name??t(k).name??JSON.stringify(t(k))]),h(N,S)}),l(x),h(n,x)};K(R,n=>{t(e)&&n(I)})}l(O),l(u),q(()=>{ae(b,1,`w-full px-4 py-2 border rounded text-center hover:cursor-pointer ${t(e)?"bg-amber-400":"bg-white"}`),E(F,d())}),h(_,u),oe()}ie(["click"]);const Oe=(_,r,i,d,e)=>{v(r,t(r).minus({months:1}),!0),(o=>{v(i,o.days,!0),v(d,o.weekdays,!0)})(e())},je=(_,r,i,d,e)=>{v(r,t(r).plus({months:1}),!0),(o=>{v(i,o.days,!0),v(d,o.weekdays,!0)})(e())};var De=(_,r)=>v(r,!t(r)),qe=w("<div> </div>"),Ee=w("<div></div>"),Fe=(_,r,i,d,e,o)=>{t(r).set({day:t(i)})>=d.startOf("day")&&(e(t(i)),v(o,!1))},Re=w("<div> </div>"),Ae=w('<div class="flex-center"><div class="absolute mt-1 p-2 w-80 bg-[#7d1b1f] border-2 rounded-xl border-white z-10"><div class="flex justify-between items-center mb-2 text-white"><button class="hover:bg-green-400 text-sm" type="button">Previous</button> <div class="font-bold"> </div> <button class="hover:bg-green-400 text-sm" type="button">Next</button></div> <div class="grid grid-cols-7 text-center bold text-white gap-3"></div> <div class="grid grid-cols-7 text-center text-white gap-3"></div></div></div>'),Ie=w('<div class="relative"><div> </div> <!></div>');function Ne(_,r){ne(r,!0);let i=H.now(),d=C(M(i)),e=C(M(H.now().set({day:1}))),o=C(!1),g,u=re(r,"value",15);const b=()=>{const c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],f=t(e).weekday%7,J=t(e).daysInMonth,P=[];for(let y=0;y<f;y++)P.push("");for(let y=1;y<=J;y++)P.push(y);return{days:P,weekdays:c}};let F=b(),O=C(M(F.days)),R=C(M(F.weekdays));const I=c=>{if(!c)return;const f=t(e).set({day:c});f>=i.startOf("day")&&v(d,f,!0),u(f)};me(()=>{const c=f=>{g&&!g.contains(f.target)&&v(o,!1)};return document.addEventListener("click",c),()=>document.removeEventListener("click",c)});var n=Ie(),x=p(n);x.__click=[De,o];var N=p(x,!0);l(x);var k=m(x,2);{var S=c=>{var f=Ae(),J=p(f),P=p(J),y=p(P);y.__click=[Oe,e,O,R,b];var L=m(y,2),Q=p(L,!0);l(L);var U=m(L,2);U.__click=[je,e,O,R,b],l(P);var W=m(P,2);X(W,21,()=>t(R),Z,(j,T)=>{var D=qe(),z=p(D,!0);l(D),q(()=>E(z,t(T))),h(j,D)}),l(W);var B=m(W,2);X(B,21,()=>t(O),Z,(j,T)=>{var D=fe(),z=ve(D);{var ee=a=>{var s=Ee();h(a,s)},te=a=>{var s=Re();s.__click=[Fe,e,T,i,I,o];var $=p(s,!0);l(s),q(A=>{ae(s,1,`rounded p-1 cursor-pointer
                    ${A??""}`),E($,t(T))},[()=>t(e).set({day:t(T)}).hasSame(t(d),"day")?"bg-green-400 text-white hover:bg-green-400":t(e).set({day:t(T)})<i?"bg-gray-500 hover:cursor-not-allowed opacity-50":"bg-red-400 `text-white hover:bg-green-400"]),h(a,s)};K(z,a=>{t(T)===""?a(ee):a(te,!1)})}h(j,D)}),l(B),l(J),l(f),q(j=>E(Q,j),[()=>t(e).toFormat("MMMM yyyy")]),h(c,f)};K(k,c=>{t(o)&&c(S)})}l(n),ue(n,c=>g=c,()=>g),q(c=>{ae(x,1,`w-50 px-4 py-2 border rounded text-center cursor-pointer ${t(o)?"bg-amber-400":"bg-white"}`),E(N,c)},[()=>t(d).toFormat("dd MMMM yyyy")]),h(_,n),oe()}ie(["click"]);var Je=w('<div class="lds-dual-ring"></div>'),Le=w('<label class="- hover:cursor-pointer"><input type="radio" class="mt-2"/> </label>'),We=w('<div class="flex flex-row space-x-10"></div>'),ze=(_,r)=>{v(r,"")},$e=w(`<div class="flex flex-col items-center justify-center absolute 
         top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 
         h-45 w-80 bg-[#7d1b1f] rounded-2xl text-white font-semibold p-4 border-2 border-white"><div class="w-full text-center flex flex-col justify-center items-center"><div class="flex font-bold text-white text-lg">Please pick at least 1 treatment</div></div> <button type="button" class="bg-red-400 hover:bg-green-400">Noted</button></div>`),Be=w(`<div class="h-screen justify-center items-center flex"><form method="POST" class="bg-gradient-to-br from-[#7d1b1f] to-red-700
flex-center flex-col w-[75%] rounded-2xl outline-2 outline-white shadow-2xl shadow-cyan-800 p-2  md:w-1/3 "><div class=" text-xl font-semibold text-[#E8C6A0]">Consultation</div> <!> <div><label for="first_name" class="mb-2">Your name</label> <input type="text" id="first_name" placeholder="John" class="text-center" required/></div> <!> <!> <div class="text-[#E8C6A0] font-semibold text-xl">Standard Treatment</div> <!> <div class="text-[#E8C6A0] font-semibold text-xl">TCM Wellness Program</div> <!> <div class="text-[#E8C6A0] font-semibold text-xl">Packaged Treatment</div> <!> <div class="text-[#E8C6A0] font-semibold text-xl text-outline"> </div> <label for="additional">Additional request</label> <textarea id="additional" placeholder="I would like a female masseur" class=" bg-white rounded flex mb-2 border-2 border-transparent focus:border-emerald-900 focus:outline-none focus:border-2 focus-within:bg-amber-400 font-semibold h-20 w-50"></textarea> <button type="submit" class=" bg-white hover:bg-green-400 px-10">Submit</button></form></div> <!>`,1);function ot(_,r){ne(r,!0);const i=[];let d=C(!1),e=M({loyaltyCheck:"",name:"",appointmentDate:H.now(),appointmentTime:H.now().plus({hours:1}).toFormat("h a"),standardTreatmentSelected:{starting_price:0,english_name:""},wellnessProgrammeSelected:{starting_price:0,english_name:""},packagedTreatmentSelected:{starting_price:0,english_name:""},additionalRequest:"",price:""});e.loyaltyCheck=r.data.consultation.find(a=>a.english_name==="First"),_e(()=>{e.price=t(o)});let o=le(()=>Number(e.loyaltyCheck.starting_price+e.standardTreatmentSelected.starting_price+e.wellnessProgrammeSelected.starting_price+e.packagedTreatmentSelected.starting_price)),g=M([]),u=M([]),b=C(""),F=C("");const O=async a=>{if(a.preventDefault(),!e.standardTreatmentSelected.english_name&&!e.wellnessProgrammeSelected.english_name&&!e.packagedTreatmentSelected.english_name){v(d,!0);return}e.standardTreatmentSelected.english_name&&(g.push(e.standardTreatmentSelected.english_name),u.push(e.standardTreatmentSelected)),e.wellnessProgrammeSelected.english_name&&(g.push(e.wellnessProgrammeSelected.english_name),u.push(e.wellnessProgrammeSelected)),e.packagedTreatmentSelected.english_name&&(g.push(e.packagedTreatmentSelected.english_name),u.push(e.packagedTreatmentSelected)),g.length===1?v(b,`The treatment I booked is ${g}.`):v(b,`The treatments I booked are ${g.join(",")}.`),v(F,`This is ${e.name}, I would like to book a treatment at around $${t(o).toFixed(2)} on ${e.appointmentDate.toFormat("dd MMMM yyyy")} at ${e.appointmentTime}.${t(b)}.${e.additionalRequest}`);const s=M({loyaltyCheck:e.loyaltyCheck,name:e.name,appointmentDate:e.appointmentDate,appointmentTime:e.appointmentTime,additionalRequest:e.additionalRequest,price:e.price,treatments:u}),Y=(await(await fetch("/api/appointment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json())._id;await we(`/booking/${Y}`),window.open(`https://wa.me/6582881687?text=${t(F)}`,"_blank")},R=10,I=21;H.now();let n=e.appointmentDate,x=M([]);for(let a=n.hour+1;a<=I;a++)x.push(n.set({hour:a,minute:0}).toFormat("h a"));let N=M([]);for(let a=R;a<=I;a++)N.push(n.set({hour:a,minute:0}));var k=Be(),S=ve(k),c=p(S),f=m(p(c),2);{var J=a=>{var s=Je();h(a,s)},P=a=>{var s=We();X(s,21,()=>r.data.consultation,Z,($,A)=>{var Y=Le(),G=p(Y);de(G);var se,pe=m(G);l(Y),q(()=>{se!==(se=t(A))&&(G.value=(G.__value=t(A))??""),E(pe,` ${t(A).english_name??""}`)}),ye(i,[],G,()=>(t(A),e.loyaltyCheck),ge=>e.loyaltyCheck=ge),h($,Y)}),l(s),h(a,s)};K(f,a=>{r.data.consultation?a(P,!1):a(J)})}var y=m(f,2),L=m(p(y),2);de(L),l(y);var Q=m(y,2);Ne(Q,{get value(){return e.appointmentDate},set value(a){e.appointmentDate=a}});var U=m(Q,2);{let a=le(()=>N.map(s=>s.toFormat("h a")));V(U,{get options(){return t(a)},get selected(){return e.appointmentTime},get value(){return e.appointmentTime},set value(s){e.appointmentTime=s}})}var W=m(U,4);V(W,{get options(){return r.data.standardTreatment},selected:"Select only if required",get value(){return e.standardTreatmentSelected},set value(a){e.standardTreatmentSelected=a}});var B=m(W,4);V(B,{get options(){return r.data.wellnessProgramme},selected:"Select only if required",get value(){return e.wellnessProgrammeSelected},set value(a){e.wellnessProgrammeSelected=a}});var j=m(B,4);V(j,{get options(){return r.data.packagedTreatment},selected:"Select only if required",get value(){return e.packagedTreatmentSelected},set value(a){e.packagedTreatmentSelected=a}});var T=m(j,2),D=p(T);l(T);var z=m(T,4);be(z),he(2),l(c),l(S);var ee=m(S,2);{var te=a=>{var s=$e(),$=m(p(s),2);$.__click=[ze,d],l(s),h(a,s)};K(ee,a=>{t(d)&&a(te)})}q(a=>E(D,`Cost Estimated: $${a??""}`),[()=>t(o).toFixed(2)]),xe("submit",c,O),ce(L,()=>e.name,a=>e.name=a),ce(z,()=>e.additionalRequest,a=>e.additionalRequest=a),h(_,k),oe()}ie(["click"]);export{ot as component,nt as universal};
