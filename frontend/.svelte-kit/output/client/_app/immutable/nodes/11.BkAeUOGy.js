import"../chunks/Bzak7iHL.js";import{p as re,f as y,i as C,d as m,t as q,b as h,c as ne,s as u,g as v,h as t,r as s,v as N,e as fe,a as ce,$ as pe,u as se,aN as _e,n as be}from"../chunks/CJVsommG.js";import{d as oe,s as A,e as he}from"../chunks/Bvs2wB4v.js";import{i as Q}from"../chunks/DKAvoKBK.js";import{e as Z,i as $}from"../chunks/DTXUD98A.js";import{r as le}from"../chunks/CQT5mLoH.js";import{b as de,a as xe}from"../chunks/B6hzIB13.js";import{g as ye}from"../chunks/BYlzNyLa.js";import{o as ve}from"../chunks/BJDSiOLn.js";import{s as te}from"../chunks/CGsQY4MI.js";import{b as ue}from"../chunks/Bznqzo7l.js";import{p as ae}from"../chunks/CvD_Fhpf.js";import{D as K}from"../chunks/n6HvnmwO.js";const we=async({fetch:_})=>{try{const n=await(await _("/api/service")).json(),l=n.filter(g=>g.category==="Consultation"),e=n.filter(g=>g.category==="Standard Treatment"),i=n.filter(g=>g.category==="TCM Wellness Program"),f=n.filter(g=>g.category==="Package Price");return{consultation:l,standardTreatment:e,wellnessProgramme:i,packagedTreatment:f}}catch(r){console.error("Error fetching appointments:",r)}},rt=Object.freeze(Object.defineProperty({__proto__:null,load:we},Symbol.toStringTag,{value:"Module"}));var ke=(_,r)=>{v(r,!t(r))},Te=(_,r,n,l,e)=>{r(t(n)),l(t(n)),v(e,!1)},Se=y('<div class="px-4 py-1 text-center hover:bg-amber-400 cursor-pointer"> </div>'),Me=y('<div class="absolute w-full z-50 bg-white mt-1 shadow"></div>'),Ce=y('<div class="w-50 mx-auto relative"><div> </div> <div class="relative"><!></div></div>');function X(_,r){re(r,!0);let n=ae(r,"value",15),l=ae(r,"selected",7),e=C(""),i=C("");ve(()=>{const o=b=>{t(i)&&!t(i).contains(b.target)&&v(e,!1)};return document.addEventListener("click",o),()=>{document.removeEventListener("click",o)}});const f=o=>{typeof o=="string"?(l(o),n(o)):typeof o=="object"&&o!==null&&(l(o.english_name??o.name??JSON.stringify(o)),n(o)),v(e,!1)};var g=Ce(),x=m(g);x.__click=[ke,e];var R=m(x,!0);s(x),ue(x,o=>v(i,o),()=>t(i));var D=u(x,2),E=m(D);{var I=o=>{var b=Me();Z(b,21,()=>r.options,$,(J,w)=>{var M=Se();M.__click=[Te,f,w,n,e];var c=m(M,!0);s(M),q(p=>A(c,p),[()=>typeof t(w)=="string"?t(w):t(w).english_name??t(w).name??JSON.stringify(t(w))]),h(J,M)}),s(b),h(o,b)};Q(E,o=>{t(e)&&o(I)})}s(D),s(g),q(()=>{te(x,1,`w-full px-4 py-2 border rounded text-center hover:cursor-pointer ${t(e)?"bg-amber-400":"bg-white"}`),A(R,l())}),h(_,g),ne()}oe(["click"]);const Pe=(_,r,n,l,e)=>{v(r,t(r).minus({months:1}),!0),(i=>{v(n,i.days,!0),v(l,i.weekdays,!0)})(e())},Oe=(_,r,n,l,e)=>{v(r,t(r).plus({months:1}),!0),(i=>{v(n,i.days,!0),v(l,i.weekdays,!0)})(e())};var je=(_,r)=>v(r,!t(r)),De=y("<div> </div>"),Ee=y("<div></div>"),Fe=(_,r,n,l,e,i)=>{t(r).set({day:t(n)})>=l.startOf("day")&&(e(t(n)),v(i,!1))},qe=y("<div> </div>"),Ne=y('<div class="flex-center"><div class="absolute mt-1 p-2 w-80 bg-[#7d1b1f] border-2 rounded-xl border-white z-10"><div class="flex justify-between items-center mb-2 text-white"><button class="hover:bg-green-400 text-sm" type="button">Previous</button> <div class="font-bold"> </div> <button class="hover:bg-green-400 text-sm" type="button">Next</button></div> <div class="grid grid-cols-7 text-center bold text-white gap-3"></div> <div class="grid grid-cols-7 text-center text-white gap-3"></div></div></div>'),Ae=y('<div class="relative"><div> </div> <!></div>');function Ie(_,r){re(r,!0);let n=K.now(),l=C(N(n)),e=C(N(K.now().set({day:1}))),i=C(!1),f,g=ae(r,"value",15);const x=()=>{const c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],p=t(e).weekday%7,L=t(e).daysInMonth,S=[];for(let k=0;k<p;k++)S.push("");for(let k=1;k<=L;k++)S.push(k);return{days:S,weekdays:c}};let R=x(),D=C(N(R.days)),E=C(N(R.weekdays));const I=c=>{if(!c)return;const p=t(e).set({day:c});p>=n.startOf("day")&&v(l,p,!0),g(p)};ve(()=>{const c=p=>{f&&!f.contains(p.target)&&v(i,!1)};return document.addEventListener("click",c),()=>document.removeEventListener("click",c)});var o=Ae(),b=m(o);b.__click=[je,i];var J=m(b,!0);s(b);var w=u(b,2);{var M=c=>{var p=Ne(),L=m(p),S=m(L),k=m(S);k.__click=[Pe,e,D,E,x];var W=u(k,2),U=m(W,!0);s(W);var V=u(W,2);V.__click=[Oe,e,D,E,x],s(S);var z=u(S,2);Z(z,21,()=>t(E),$,(P,O)=>{var j=De(),Y=m(j,!0);s(j),q(()=>A(Y,t(O))),h(P,j)}),s(z);var B=u(z,2);Z(B,21,()=>t(D),$,(P,O)=>{var j=fe(),Y=ce(j);{var ee=d=>{var T=Ee();h(d,T)},a=d=>{var T=qe();T.__click=[Fe,e,O,n,I,i];var F=m(T,!0);s(T),q(G=>{te(T,1,`rounded p-1 cursor-pointer
                    ${G??""}`),A(F,t(O))},[()=>t(e).set({day:t(O)}).hasSame(t(l),"day")?"bg-green-400 text-white hover:bg-green-400":t(e).set({day:t(O)})<n?"bg-gray-500 hover:cursor-not-allowed opacity-50":"bg-red-400 `text-white hover:bg-green-400"]),h(d,T)};Q(Y,d=>{t(O)===""?d(ee):d(a,!1)})}h(P,j)}),s(B),s(L),s(p),q(P=>A(U,P),[()=>t(e).toFormat("MMMM yyyy")]),h(c,p)};Q(w,c=>{t(i)&&c(M)})}s(o),ue(o,c=>f=c,()=>f),q(c=>{te(b,1,`w-50 px-4 py-2 border rounded text-center cursor-pointer ${t(i)?"bg-amber-400":"bg-white"}`),A(J,c)},[()=>t(l).toFormat("dd MMMM yyyy")]),h(_,o),ne()}oe(["click"]);var Re=y('<div class="lds-dual-ring"></div>'),Je=y('<label class="- hover:cursor-pointer"><input type="radio" class="mt-2"/> </label>'),Le=y('<div class="flex flex-row space-x-10"></div>'),We=(_,r)=>{v(r,"")},ze=y(`<div class="flex flex-col items-center justify-center absolute 
         top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 
         h-45 w-80 bg-[#7d1b1f] rounded-2xl text-white font-semibold p-4 border-2 border-white"><div class="w-full text-center flex flex-col justify-center items-center"><div class="flex font-bold text-white text-lg">Please pick at least 1 treatment</div></div> <button type="button" class="bg-red-400 hover:bg-green-400">Noted</button></div>`),Be=y(`<div class="h-screen justify-center items-center flex"><form method="POST" class="bg-gradient-to-br from-[#7d1b1f] to-red-700
flex-center flex-col w-[75%] rounded-2xl outline-2 outline-white shadow-2xl shadow-cyan-800 p-2  md:w-1/3 "><div class=" text-xl font-semibold text-[#E8C6A0]">Consultation</div> <!> <div><label for="first_name" class="mb-2">Your name</label> <input type="text" id="first_name" placeholder="John" class="text-center" required/></div> <!> <!> <div class="text-[#E8C6A0] font-semibold text-xl">Standard Treatment</div> <!> <div class="text-[#E8C6A0] font-semibold text-xl">TCM Wellness Program</div> <!> <div class="text-[#E8C6A0] font-semibold text-xl">Packaged Treatment</div> <!> <div class="text-[#E8C6A0] font-semibold text-xl text-outline"> </div> <label for="additional">Additional request</label> <textarea id="additional" placeholder="I would like a female masseur" class=" bg-white rounded flex mb-2 border-2 border-transparent focus:border-emerald-900 focus:outline-none focus:border-2 focus-within:bg-amber-400 font-semibold h-20 w-50"></textarea> <button type="submit" class=" bg-white hover:bg-green-400 px-10">Submit</button></form></div> <!>`,1);function nt(_,r){re(r,!0);const n=[];let l=C(!1),e=N({loyaltyCheck:"",name:"",appointmentDate:K.now(),appointmentTime:K.now().plus({hours:1}).toFormat("h a"),standardTreatmentSelected:{starting_price:0},wellnessProgrammeSelected:{starting_price:0},packagedTreatmentSelected:{starting_price:0},additionalRequest:"",price:""});e.loyaltyCheck=r.data.consultation.find(a=>a.english_name==="First"),pe(()=>{e.price=t(i)});let i=se(()=>Number(e.loyaltyCheck.starting_price+e.standardTreatmentSelected.starting_price+e.wellnessProgrammeSelected.starting_price+e.packagedTreatmentSelected.starting_price));console.log(r.data);let f=N([]),g=C(""),x=C("");const R=async a=>{if(a.preventDefault(),!e.standardTreatmentSelected.english_name&&!e.wellnessProgrammeSelected.english_name&&!e.packagedTreatmentSelected.english_name){v(l,!0);return}e.standardTreatmentSelected.english_name&&f.push(e.standardTreatmentSelected.english_name),e.wellnessProgrammeSelected.english_name&&f.push(e.wellnessProgrammeSelected.english_name),e.packagedTreatmentSelected.english_name&&f.push(e.packagedTreatmentSelected.english_name),f.length===1?v(g,`The treatment I booked is ${f}.`):v(g,`The treatments I booked are ${f.join(",")}.`),v(x,`This is ${e.name}, I would like to book a treatment at around $${t(i).toFixed(2)} on ${e.appointmentDate.toFormat("dd MMMM yyyy")} at ${e.appointmentTime}.${t(g)}.${e.additionalRequest}`);const F=(await(await fetch("/api/appointment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json())._id;await ye(`/booking/${F}`),window.open(`https://wa.me/6582881687?text=${t(x)}`,"_blank")},D=10,E=21;K.now();let I=e.appointmentDate,o=N([]);for(let a=I.hour+1;a<=E;a++)o.push(I.set({hour:a,minute:0}).toFormat("h a"));let b=N([]);for(let a=D;a<=E;a++)b.push(I.set({hour:a,minute:0}));var J=Be(),w=ce(J),M=m(w),c=u(m(M),2);{var p=a=>{var d=Re();h(a,d)},L=a=>{var d=Le();Z(d,21,()=>r.data.consultation,$,(T,F)=>{var G=Je(),H=m(G);le(H);var ie,me=u(H);s(G),q(()=>{ie!==(ie=t(F))&&(H.value=(H.__value=t(F))??""),A(me,` ${t(F).english_name??""}`)}),xe(n,[],H,()=>(t(F),e.loyaltyCheck),ge=>e.loyaltyCheck=ge),h(T,G)}),s(d),h(a,d)};Q(c,a=>{r.data.consultation?a(L,!1):a(p)})}var S=u(c,2),k=u(m(S),2);le(k),s(S);var W=u(S,2);Ie(W,{get value(){return e.appointmentDate},set value(a){e.appointmentDate=a}});var U=u(W,2);{let a=se(()=>b.map(d=>d.toFormat("h a")));X(U,{get options(){return t(a)},get selected(){return e.appointmentTime},get value(){return e.appointmentTime},set value(d){e.appointmentTime=d}})}var V=u(U,4);X(V,{get options(){return r.data.standardTreatment},selected:"Select only if required",get value(){return e.standardTreatmentSelected},set value(a){e.standardTreatmentSelected=a}});var z=u(V,4);X(z,{get options(){return r.data.wellnessProgramme},selected:"Select only if required",get value(){return e.wellnessProgrammeSelected},set value(a){e.wellnessProgrammeSelected=a}});var B=u(z,4);X(B,{get options(){return r.data.packagedTreatment},selected:"Select only if required",get value(){return e.packagedTreatmentSelected},set value(a){e.packagedTreatmentSelected=a}});var P=u(B,2),O=m(P);s(P);var j=u(P,4);_e(j),be(2),s(M),s(w);var Y=u(w,2);{var ee=a=>{var d=ze(),T=u(m(d),2);T.__click=[We,l],s(d),h(a,d)};Q(Y,a=>{t(l)&&a(ee)})}q(a=>A(O,`Cost Estimated: $${a??""}`),[()=>t(i).toFixed(2)]),he("submit",M,R),de(k,()=>e.name,a=>e.name=a),de(j,()=>e.additionalRequest,a=>e.additionalRequest=a),h(_,J),ne()}oe(["click"]);export{nt as component,rt as universal};
